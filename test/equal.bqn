âŸ¨ListVariations, ClearRefs, Variation, Squeeze, InfoâŸ© â† â€¢internal
u â† â€¢UnixTime@
# u â†© 1648896733

r â† â€¢MakeRand â€¢Show u

TestVars â† { wğ•Šaâ€¿b:
  n â† Â¬w
  (ListVariations a) {
    Â¬âŸn (ğ•¨ Variation a) â‰¡ (ğ•© Variation b)? @;
    â€¢Out âˆ¾"fail for "â€¿ğ•¨â€¿"/"â€¿ğ•©â€¿", expected "â€¿(wâŠ‘"0"â€¿"1")â€¿":"
    â€¢Out â€¢Repr a
    â€¢Out â€¢Repr b
    â€¢Out â€¢Repr aâ‰ b
    â€¢Exit 1
  }âŒœ ListVariations b
  ClearRefs@
}

(1 TestVars â‹ˆËœ)Â¨ âŸ¨âŸ¨âŸ© â‹„ "" â‹„ â†•0âŸ©

# types: u1,i8,i16,i32,f64,c8,c16,c32
szs â† 2âˆ¾(2â‹†8â€¿16â€¿32)âˆ¾0âˆ¾(2â‹†8â€¿16)âˆ¾1114111
off â† 0âˆ¾(2â‹†7â€¿15â€¿31)âˆ¾Â¯0.5âˆ¾0â€¿0â€¿0
chr â† 0â€¿0â€¿0â€¿0â€¿0â€¿1â€¿1â€¿1
specF64 â† âˆ¾âŸœ- Ã·âŸœ0âŠ¸âˆ¾ 1â€¿0
RandVal â† {
  ğ•©â‰¡4? {specF64âŠËœğ•© r.Range â‰ specF64}âˆ˜â‰ âŒ¾((0=ğ•¨ r.Range 2â‹†r.Range 10)âŠ¸/) ğ•¨ r.Range 0;
  Squeeze @+âŸ(ğ•©âŠ‘chr) (ğ•¨ r.Range ğ•©âŠ‘szs) - ğ•©âŠ‘off
}

Do â† { ğ•Š:
  at â† r.Range 8
  l â† 1 + r.Range (at=0)âŠ‘100â€¿700
  a â† l RandVal at
  (âŠ¢â—¶1â€¿{ğ•Š:âˆ§Â´a=a} at=4) TestVars aâ€¿a
  { ğ•Š:
    p â† r.Range l
    v â† âŠ‘1 RandVal âŠ¢â—¶âŸ¨r.Rangeâˆ˜5 â‹„ 5+r.Rangeâˆ˜3âŸ© atâ‰¥5
    exp â† v = pâŠ‘a
    b â† Squeeze vâŒ¾(pâŠ¸âŠ‘) a
    (âŠ¢â—¶expâ€¿{ğ•Š:âˆ§Â´a=b} at=4) TestVars aâ€¿b
  }âŸ100 @
}

@âˆ˜DoâŸ1000 @