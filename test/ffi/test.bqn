fâ†@
Section â† {â€¢Out ð•©âˆ¾Ëœ@+10}

f â†© "lib.so" â€¢FFI ""â€¿"do_nothing" â‹„ â€¢Show F âŸ¨âŸ©

Section "# ""a"""
f â†© "lib.so" â€¢FFI "i32"â€¿"getType"â€¿">a" â‹„ â€¢Show FÂ¨ âŸ¨âŸ¨âŸ©, 1, 'ð•©', +, Â¨, âˆ˜, {â‡}âŸ©
f â†© "lib.so" â€¢FFI "a"â€¿"timesTen"â€¿"a" â‹„ â€¢Show F âŸ¨â†•10âŸ©
f â†© "lib.so" â€¢FFI "a"â€¿"readAtoms"â€¿"a"â€¿"a" â‹„ â€¢Show F âŸ¨Ã·5 â‹„ 'ð•¨'âŸ©
f â†© "lib.so" â€¢FFI "a"â€¿"readTyped"â€¿">a" â‹„ â€¢Show F (10Ã—â†•7) + (4â¥Š<â†•10)âˆ¾3â¥Š<@+â†•10
f â†© "lib.so" â€¢FFI "a"â€¿"getShape"â€¿">a" â‹„ â€¢Show FÂ¨ {0â¥ŠËœâŒ½âŸð•©â†•ð•©}Â¨ â†•5
f â†© "lib.so" â€¢FFI "a"â€¿"evalBQN"â€¿">a" â‹„ â€¢Show F "â†•5"
f â†© "lib.so" â€¢FFI "a"â€¿"makeArrays" â‹„ â€¢Outâˆ˜â€¢ReprÂ¨ F âŸ¨âŸ©
f â†© "lib.so" â€¢FFI "a"â€¿"makeThree"â€¿">a" â‹„ â€¢Show F "foo"
f â†© "lib.so" â€¢FFI "i32"â€¿"directAccess"â€¿">a" â‹„ â€¢Show F "Ai32"â€¢internal.Variation â†•10
bind â† "lib.so" â€¢FFI "a"â€¿"bindAdd"â€¿">a" â‹„ g â† Bind 4 â‹„ â€¢Show G 123

Section "# namespaces"
f â†© "lib.so" â€¢FFI "a"â€¿"getField"â€¿">ð•¨a"â€¿"a"â€¿"a" â‹„ â€¢Show {abâ‡1â€¿2 â‹„ cdâ‡3â€¿4} F âŸ¨"ab" â‹„ "default"âŸ©
f â†© "lib.so" â€¢FFI "a"â€¿"getField"â€¿">ð•¨a"â€¿"a"â€¿"a" â‹„ â€¢Show {abâ‡1â€¿2 â‹„ cdâ‡3â€¿4} F âŸ¨"ef" â‹„ "default"âŸ©

Section "# print args"
f â†© "lib.so" â€¢FFI ""â€¿"printArgs"â€¿"i8"â€¿"i16"â€¿"i32"â€¿"u8"â€¿"u16"â€¿"u32"â€¿"f32"â€¿"f64" â‹„ â€¢Show F Â¯123â€¿Â¯12323â€¿Â¯212312312â€¿250â€¿50000â€¿3123456789â€¿Ï€âˆ¾Ã·3
f â†© "lib.so" â€¢FFI ""â€¿ "noopArgs"â€¿"i8"â€¿"i16"â€¿"i32"â€¿"u8"â€¿"u16"â€¿"u32"â€¿"f32"â€¿"f64" â‹„ â€¢Show F Â¯123â€¿Â¯12323â€¿Â¯212312312â€¿250â€¿50000â€¿3123456789â€¿Ï€âˆ¾Ã·3
f â†© "lib.so" â€¢FFI ""â€¿"printPtrArgs"â€¿"*i8"â€¿"*i16"â€¿"*i32"â€¿"*u8"â€¿"*u16"â€¿"*u32"â€¿"*f32"â€¿"*f64" â‹„ â€¢Show F â¥ŠÂ¨Â¯123â€¿Â¯12323â€¿Â¯212312312â€¿250â€¿50000â€¿3123456789â€¿Ï€âˆ¾Ã·3
f â†© "lib.so" â€¢FFI ""â€¿"printPtrArgs"â€¿"&i8"â€¿"&i16"â€¿"&i32"â€¿"&u8"â€¿"&u16"â€¿"&u32"â€¿"&f32"â€¿"&f64" â‹„ â€¢Show F â¥ŠÂ¨Â¯123â€¿Â¯12323â€¿Â¯212312312â€¿250â€¿50000â€¿3123456789â€¿Ï€âˆ¾Ã·3

f â†© "lib.so" â€¢FFI "f32"â€¿"printU64s"â€¿"u64:c8"â€¿"*u64:c8" â‹„ â€¢Show F âŸ¨"hellowor", "aaaaaaaa12345678texttext"âŸ©
f â†© "lib.so" â€¢FFI "f32"â€¿"printU64s"â€¿"u64:u1"â€¿"*u64:u1" â‹„ â€¢Show F âŸ¨64â†‘âˆ¾Ã—âˆ˜â†•Â¨â†•12, 192â†‘âˆ¾Ã—âˆ˜â†•Â¨â†•21âŸ©

! 3 â‰¡ â€¢Type "lib.so" â€¢FFI ""â€¿"printArgs"â€¿"i8"â€¿"i16:c8"â€¿"i32"â€¿"u8"â€¿"u16"â€¿"u32"â€¿"f32"â€¿"f64"
! 3 â‰¡ â€¢Type "lib.so" â€¢FFI ""â€¿"printArgs"â€¿"i8"â€¿"i16:c16"â€¿"i32"â€¿"u8"â€¿"u16"â€¿"u32"â€¿"f32"â€¿"f64"
! 3 â‰¡ â€¢Type "lib.so" â€¢FFI ""â€¿"printArgs"â€¿"i8:c8"â€¿"i16"â€¿"i32"â€¿"u8"â€¿"u16"â€¿"u32"â€¿"f32"â€¿"f64"

Section "# read pointers"
f â†© "lib.so" â€¢FFI "i32"â€¿"multiplyI32Ptrs"â€¿"*i32"â€¿"*i32"â€¿"i32" â‹„ â€¢Show F âŸ¨â†•10 â‹„ â€¢Show âŒ½â†•10 â‹„ â€¢Show 10âŸ©
f â†© "lib.so" â€¢FFI "f32"â€¿"sumF32Arr"â€¿"*f32:i32"â€¿"i32" â‹„ â€¢Show F âŸ¨1065353216â€¿1073741824â€¿1077936128â€¿1082130432â€¿1084227584â€¿1086324736â€¿1088421888â€¿1090519040â€¿1091567616â€¿1092616192,10âŸ©

Section "# mutate i32*"
f â†© "lib.so" â€¢FFI âŸ¨"","incI32s","&u32",      "i32"âŸ© â‹„ â€¢Show F âŸ¨1e8Ã—20+â†•10 â‹„ 10âŸ©
f â†© "lib.so" â€¢FFI âŸ¨"","incI32s","&i32:u1",   "i32"âŸ© â‹„ â€¢Show âŠ‘F âŸ¨1â€¿0â€¿1â€¿0â€¿1â€¿0â€¿1â€¿0â€¿0â€¿1â€¿0â€¿1â€¿0â€¿0â€¿1â€¿1â€¿0â€¿1â€¿1â€¿0â€¿0â€¿0â€¿0â€¿1â€¿0â€¿1â€¿0â€¿1â€¿0â€¿0â€¿1â€¿0â€¿0â€¿0â€¿1â€¿0â€¿0â€¿0â€¿1â€¿0â€¿0â€¿0â€¿1â€¿1â€¿1â€¿0â€¿1â€¿1â€¿1â€¿1â€¿1â€¿1â€¿0â€¿0â€¿1â€¿1â€¿0â€¿0â€¿1â€¿0â€¿0â€¿1â€¿0â€¿0, 2âŸ©
f â†© "lib.so" â€¢FFI âŸ¨"","incI32s","&i32:c8",   "i32"âŸ© â‹„ â€¢Show âŠ‘F âŸ¨"helloworld", 2âŸ©
f â†© "lib.so" â€¢FFI âŸ¨"","incI32s",">ð•¨&i32:c8",">i32"âŸ© â‹„ â€¢Show âŠ‘ "helloworld" F 2

f â†© "lib.so" â€¢FFI âŸ¨"", "incI32s",  "&i32:c8",  "i32"âŸ© â‹„ â€¢Show âŠ‘F âŸ¨"helloworld", 2âŸ©
f â†© "lib.so" â€¢FFI âŸ¨"", "incI32s",  "&i32:c8", "ð•¨i32"âŸ© â‹„ â€¢Show âŠ‘ âŸ¨2âŸ© F âŸ¨"helloworld"âŸ©
f â†© "lib.so" â€¢FFI âŸ¨"", "incI32s",  "&i32:c8",">ð•¨i32"âŸ© â‹„ â€¢Show âŠ‘ 2 F âŸ¨"helloworld"âŸ©
f â†© "lib.so" â€¢FFI âŸ¨"", "incI32s", ">&i32:c8",">ð•¨i32"âŸ© â‹„ â€¢Show âŠ‘ 2 F "helloworld"
f â†© "lib.so" â€¢FFI âŸ¨"", "incI32s",">ð•¨&i32:c8", ">i32"âŸ© â‹„ â€¢Show âŠ‘ "helloworld" F 2
f â†© "lib.so" â€¢FFI âŸ¨"", "incI32s",  "&i32:c8",  "i32"âŸ© â‹„ â€¢Show F âŸ¨"helloworld", 2âŸ©
f â†© "lib.so" â€¢FFI âŸ¨"&","incI32s",  "&i32:c8",  "i32"âŸ© â‹„ â€¢Show F âŸ¨"helloworld", 2âŸ©

Section "# mutate i32*, i16*, i8*"
f â†© "lib.so" â€¢FFI âŸ¨"","incInts","&i32",  "&i16","&i8"âŸ© â‹„ â€¢Show F â¥ŠÂ¨ 10â€¿20â€¿30
f â†© "lib.so" â€¢FFI âŸ¨"","incInts","&i32", "ð•¨&i16","&i8"âŸ© â‹„ â€¢Show âŸ¨â¥Š20âŸ© F â¥ŠÂ¨ 10â€¿30
f â†© "lib.so" â€¢FFI âŸ¨"","incInts","&i32",">ð•¨&i16","&i8"âŸ© â‹„ â€¢Show âŸ¨20âŸ© F â¥ŠÂ¨ 10â€¿30

Section "# u64 tests"
f â†© "lib.so" â€¢FFI âŸ¨"u64",    "ident_u64",">u64:i32"âŸ© â‹„ â€¢Show F 1234â€¿12
f â†© "lib.so" â€¢FFI âŸ¨"u64",    "ident_u64",">u64"    âŸ© â‹„ â€¢Show F +Â´2â‹†52â€¿20
f â†© "lib.so" â€¢FFI âŸ¨"u64:i32","ident_u64",">u64"    âŸ© â‹„ â€¢Show F 123456789123456
f â†© "lib.so" â€¢FFI âŸ¨"u64:u1", "ident_u64",">u64:c8" âŸ© â‹„ â€¢Show F "hellowor"

Section "# malloc test"
f â†© "lib.so" â€¢FFI "*:i32"â€¿"malloc"â€¿">u64" â‹„ â€¢Show (â€¢internal.Infoâ‹ˆâ‰ ) malloc â† F 123
f â†© "lib.so" â€¢FFI ""â€¿"free"â€¿">*:i32" â‹„ F malloc

Section "# pick item"
f â†© "lib.so" â€¢FFI "*:i8"â€¿"pick_ptr"â€¿">**:i8"â€¿">ð•¨i32" â‹„ â€¢Show @+0 F "helloworfoobarba"-@
f â†© "lib.so" â€¢FFI "*:c8"â€¿"pick_ptr"â€¿">**:c8"â€¿">ð•¨i32" â‹„ â€¢Show   0 F "helloworfoobarba"
f â†© "lib.so" â€¢FFI âŸ¨"u64:i8","pick_u64",">*u64:i8",">ð•¨i32"âŸ© â‹„ â€¢Show @+2 F "000000001234560011122100abacabad"-@
f â†© "lib.so" â€¢FFI âŸ¨"u64:i8","pick_u64",">*u64:i8",">ð•¨i32"âŸ© â‹„ â€¢Show @+3 F "000000001234560011122100abacabad"-@
f â†© "lib.so" â€¢FFI âŸ¨"u64",   "pick_u64",">*u64:i8",">ð•¨i32"âŸ© â‹„ â€¢Show   1 F "000000001234560011122100"-'0'


# erroring:

# "local/lib.so" â€¢FFI ""â€¿"printArgs"â€¿"i8"â€¿"i16:c32"â€¿"i32"â€¿"u8"â€¿"u16"â€¿"u32"â€¿"f32"â€¿"f64"
# "local/lib.so" â€¢FFI ""â€¿"testArgs"â€¿"i8:c16"â€¿"i16"â€¿"i32"â€¿"u8"â€¿"u16"â€¿"u32"â€¿"f32"â€¿"f64"
# "local/lib.so" â€¢FFI ""â€¿"testArgs"â€¿"i8:c32"â€¿"i16"â€¿"i32"â€¿"u8"â€¿"u16"â€¿"u32"â€¿"f32"â€¿"f64"

# f â†© "local/lib.so" â€¢FFI "u64"â€¿"ident_u64"â€¿">u64:i32" â‹„ â€¢Show F 1234â€¿12344444
# f â†© "local/lib.so" â€¢FFI "u64"â€¿"ident_u64"â€¿">u64" â‹„ â€¢Show F +Â´2â‹†53â€¿20