%DEF var Vâ†â€¢internal.Variation â‹„ LVâ†â€¢internal.ListVariations â‹„ CLRâ†â€¢internal.ClearRefs
%DEF tvar %USE var â‹„ _tvar â† {F _ğ•£ x: (CLR@) âŠ¢ {F ğ•© V x}Â¨ LV ğ•©; w F _ğ•£ x: (CLR@) âŠ¢ (LV ğ•¨) {(ğ•¨ V w) F ğ•© V x}âŒœ LV ğ•©}
%DEF eqvar %USE tvar â‹„ _eqvar â† {r â† ğ•¨ ğ”½ _tvar ğ•© â‹„ !âˆ˜â‰¡âŸœ(âŠ‘r)Â¨ r â‹„ âŠ‘r}

(
  %USE eqvar
  LV â†© ""âŠ¸LV
  Test â† { ğ•Š:
    x â† (2â€¢rand.Range 50)â€¢rand.Range 100
    w â† {0: â†•0; (1+â€¢rand.Range 50) â€¢rand.Range ğ•©} 1âŠ‘â‰¢x
    w {ğ•¨âŠ¸âŠË˜ ğ•©}_eqvar x
  }
  
  TestÂ¨ â†•1000
)

(
  Test â† {ğ•Š gen:
    { ğ•Š cam:
      {
        i â† â€¢rand.Rangeâˆ˜3â—¶âŸ¨âŠ¢, Â¯1âŠ¸-, {ğ•© - (1+2Ã—ğ•©) Ã— 2â€¢rand.RangeËœâ‰ ğ•©}âŸ© ğ•¨ â€¢rand.Range ğ•©
        ! (iâŠ¸âŠË˜ â‰¡ iâŠ¸âŠâ—‹â€¢internal.KeepË˜) Gen camâ€¿ğ•©
      }âŒœËœ 1â†“â·(â†•20)âˆ¾âŒŠ(âˆš2)â‹†â†•16
    }Â¨ 1â€¿6â€¿100
  }
  
  Test {{0 + ğ•© â€¢rand.Range 100}}
  Test {{0 + ğ•© â€¢rand.Range 1000}}
  Test {{0 + ğ•© â€¢rand.Range 1e9}}
  Test {{0 + ğ•© â€¢rand.Range 0}}
  
  Test {{@ + ğ•© â€¢rand.Range 100}}
  Test {{@ + ğ•© â€¢rand.Range 1000}}
  Test {{@ + ğ•© â€¢rand.Range 1114111}}
  Test {{âŠ‘âŸœ"foo"â€¿@Â¨ ğ•© â€¢rand.Range 2}}
)
