%DEF var Vâ†â€¢internal.Variation â‹„ LVâ†â€¢internal.ListVariations â‹„ CLRâ†â€¢internal.ClearRefs
%DEF tvar %USE var â‹„ _tvar â† {F _ğ•£ x: (CLR@) âŠ¢ {F ğ•© V x}Â¨ LV ğ•©; w F _ğ•£ x: (CLR@) âŠ¢ (LV ğ•¨) {(ğ•¨ V w) F ğ•© V x}âŒœ LV ğ•©}
%DEF eqvar âŸ¨_eqvarâŸ©â†âŠ‘â€¢args
%DEF eqvarv âŸ¨_eqvarv_âŸ©â†âŠ‘â€¢args
%DEF rand r â† (âŠ‘â€¢args).GetRand@

(
  %USE rand â‹„ %USE eqvarv
  Test â† { ğ•Š:
    x â† (2 r.Range 50) r.Range 100
    w â† {0: â†•0; (1+r.Range 50) r.Range ğ•©} 1âŠ‘â‰¢x
    w {ğ•¨âŠ¸âŠË˜ ğ•©}_eqvarv_"" x
  }
  
  TestÂ¨ â†•1000
)

(
  %USE rand
  Test â† {ğ•Š gen:
    { ğ•Š cam:
      {
        i â† r.Rangeâˆ˜3â—¶âŸ¨âŠ¢, Â¯1âŠ¸-, {ğ•© - (1+2Ã—ğ•©) Ã— 2 r.RangeËœâ‰ ğ•©}âŸ© ğ•¨ r.Range ğ•©
        ! (iâŠ¸âŠË˜ â‰¡ iâŠ¸âŠâ—‹â€¢internal.KeepË˜) Gen camâ€¿ğ•©
      }âŒœËœ 1â†“â·(â†•20)âˆ¾âŒŠ(âˆš2)â‹†â†•16
    }Â¨ 1â€¿6â€¿100
  }
  
  Test {{0 + ğ•© r.Range 100}}
  Test {{0 + ğ•© r.Range 1000}}
  Test {{0 + ğ•© r.Range 1e9}}
  Test {{0 + ğ•© r.Range 0}}
  
  Test {{@ + ğ•© r.Range 100}}
  Test {{@ + ğ•© r.Range 1000}}
  Test {{@ + ğ•© r.Range 1114111}}
  Test {{âŠ‘âŸœ"foo"â€¿@Â¨ ğ•© r.Range 2}}
)


(
  %USE rand â‹„ %USE var
  F â† {ğ•¨âŠ¸âŠË˜ ğ•©}
  {
    ğ•©+â†© 1
    is â† ğ•¨ r.Range ğ•©
    n â† r.Range 200
    d â† nâ€¿ğ•© r.Range 2
    isâ€¿nâ€¿ğ•© ! 1=â‰ â· âŸ¨is F d, is F "Ai8"V dâŸ© âˆ¾ {ğ•©=2? âŸ¨("Ai8"V is) F dâŸ©; âŸ¨âŸ©}ğ•©
  }âŒœËœ â†•10
)

(
  %USE rand â‹„ %USE var
  F â† {ğ•¨âŠ¸âŠË˜ ğ•©}âŠ'e'
  {
    ğ•©+â†© 1
    ğ•¨+â†© 1
    is â† ğ•¨â¥Šğ•©
    n â† 1+ r.Range 200
    d â† nâ€¿ğ•© r.Range 2
    
    ğ•¨â€¿ğ•©â€¿n! âˆ§Â´ 'e'âŠ¸â‰¡Â¨ âŸ¨is F d, is F "Ai8"V dâŸ© âˆ¾ {ğ•©=2? âŸ¨("Ai8"V is) F dâŸ©; âŸ¨âŸ©}ğ•©
  }âŒœËœ â†•10
)

(
  %USE rand â‹„ %USE var
  F â† {ğ•¨âŠ¸âŠË˜ ğ•©}âŠ'e'
  
  {ğ•Š inds:
    csz â† â‰ âŠ‘inds
    inds {
      âŸ¨csz, ğ•¨, â‰¢ğ•©âŸ© ! 1=â‰ â· â¥Š (VâŸœğ•¨Â¨ (âˆ§Â´ğ•¨â‰¤1)â—¶âŸ¨â‹ˆ, "Ab"âŠ¸â‹ˆâŸ© "Ai8") FâŒœ VâŸœğ•©Â¨ "Ab"â€¿"Ai8"â€¿"Ai32"
    }âŒœ {ğ•©â€¿csz r.Range 2}Â¨ (â†•8)âˆ¾â¥Š0â€¿1+âŒœ3â†“2â‹†â†•9
  }Â¨ âŸ¨â¥Šâ†•2â€¿2âŸ© âˆ¾ {âŸ¨â†•ğ•©, r.RangeËœğ•©âŸ©}Â¨ 1â€¿3â€¿4â€¿5â€¿8â€¿9â€¿16
)