### WHOLE-FILE-TEST
# generally unnecessary now that debug builds include heap corruption testing
âŸ¨LVâ‡ListVariations, Vâ‡Variation, ClearRefsâ‡ClearRefs, Iâ‡Info, TYâ‡Type, Refcâ‡Refc, EEQâ‡EEqualâŸ© â† â€¢internal
helpers â† âŠ‘â€¢args
R â† (helpers.GetRand@).Range
RB2 â† {Â¬âŸ(R 2) "Ab" V ğ•© R 1+R 2â‹†R 10} # random boolean array with random uniform probability

rByteVals â† "Ai8"V {ğ•©-256Ã—ğ•©>127} âˆ¾{{2âŠ¸Ã—âŠ¸+ËœÂ´ 8â†‘/â¼ ğ•© â€¢rand.Subset 8}Â¨ â†•9}Â¨â†•20
RByte â† (R (â‰ rByteVals)Ë™)âŠ¸(âŠ‘âŸœrByteVals)

RH â† "Ai8"âŠ¸VÂ¨ Râ¥ŠÂ¨RByte # store to a variable to randomize heap by ğ•¨ values, each up to ğ•© bytes
CH â† { # do "var CHâ†©" to a variable assigned to a result of RH
  "heap corruption" ! âˆ§Â´2=RefcÂ¨ ğ•©
  "heap corruption" ! 1 â‰¡ Refc ğ•©
  0
}
BitSlash â† {tyâ€¿dyâ€¿maxğ•Šn:
  f â† dy âŠ‘ âŸ¨/âˆ˜âŠ¢ â‹„ {ğ•©/ty V ğ•¨ R 100}âŸ©
  {ğ•Š:
    # ğ•©âŠ¸{â€¢Show ğ•¨}âŸâŠ¢ 0=10000|ğ•©
    t1â†20 RH 100
    nâ†R max
    xâ†n F nâ†‘RB2 128+n
    t2â†20 RH 100
    xâ†©0 â‹„ t1 CHâ†© â‹„ t2 CHâ†©
  }Â¨â†•n
}
â€¢Show "heap corruption test of /bit"    â‹„      @â€¿0â€¿200 BitSlash 1000000
â€¢Show "heap corruption test of bit/i8"  â‹„  "Ai8"â€¿1â€¿50  BitSlash 1000000
â€¢Show "heap corruption test of bit/i16" â‹„ "Ai16"â€¿1â€¿50  BitSlash 1000000
â€¢Show "heap corruption test of bit/i32" â‹„ "Ai32"â€¿1â€¿50  BitSlash 1000000
