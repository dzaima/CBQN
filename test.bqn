#! /usr/bin/env dbqn
"Usage: ./test.bqn path/to/mlochbaum/BQN [-qsmev] name | ./BQN"!2â‰¤â‰ â€¢args
pathâ†âŠ‘â€¢args
argsâ†1â†“â€¢args
optâ†""
{ğ•Š: optâ†©ğ•© â‹„ argsâ†“Ëœâ†©1}âŸ('-'â‰¡âŠ‘) âŠ‘args

"Missing argument!"!0<â‰ args
{
  case â† ğ•©âˆ¾".bqn"
  tests â† â€¢FLines pathâˆ¾"/test/cases/"âˆ¾case
  tests/Ëœâ†© (('#'â‰¢âŠ‘)âˆ§0<â‰ )Â¨tests
  {ğ•Š: tests/Ëœâ†©'!'â‰ âŠ‘Â¨tests}âŸâŠ‘ 's'âˆŠopt
  {ğ•Š: tests/Ëœâ†©'!'=âŠ‘Â¨tests}âŸâŠ‘ 'e'âˆŠopt
  verify â† âŠ‘'v'âˆŠopt
  RMC â† âŠâŸœ'#'âŠ‘âŠ¸â†‘âŠ¢ # doesn't work for token.bqn but whatever
  Q â† {
    iâ†âŠ‘ğ•©âŠ'%'
    ((1+'!'â‰ âŠ‘ğ•©)Ã—verify)â—¶âŸ¨(1+i)âŠ¸â†“ â‹„ {âˆ¾ âŸ¨"""should've errored!""âˆ˜â€¢BQNâŠ1 """ â‹„ {ğ•©/Ëœ1+ğ•©='"'}ğ•©â†“Ëœ1+âŠ‘ğ•©âŠ'%' â‹„ """"âŸ©} â‹„ {âˆ¾âŸ¨"""incorrect!""â€¿1âŠ‘Ëœ(" â‹„ iâ†‘ğ•© â‹„ ") â‰¡ {" â‹„ (1+i)â†“ğ•© â‹„ " }"âŸ©}âŸ© RMC ğ•©
  }
  Out â† {â€¢Out'%'âŠ¸âˆŠâ—¶(verifyâ—¶âŠ¢â€¿{âˆ¾âŸ¨"""incorrect!""â€¿1âŠ‘Ëœ1â‰¡{" â‹„ RMC ğ•© â‹„ " }"âŸ©})â€¿Qğ•©}

  ((âŠ‘'m'âˆŠopt)âŠ‘Outâ€¿{â€¢Showğ•©â‹„Outğ•©})Â¨tests
  # ('%'âŠ¸âˆŠâˆ¨ '#'= Â·âŠ‘ âˆ¾âŸœ"#")â—¶â€¢Outâ€¿@Â¨tests
}Â¨args
â€¢OutâŸ(Â¬âŠ‘'q'âˆŠopt) """finished"""
â€¢OutâŸ(Â¬âŠ‘'q'âˆŠopt) ""